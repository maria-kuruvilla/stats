setwd("~/code/stats") #change if running in different computer
data  <- read.csv("../../data/temp_collective/roi/all_params_w_loom.csv",
header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$annd)],
"gs" = data$Groupsize[complete.cases(data$annd)],
"loom" = data$Loom[complete.cases(data$annd)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$annd)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$annd)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$annd)],
"subtrial" = data$Subtrial[complete.cases(data$annd)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$annd)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$annd)], format = "%H:%M")),
"annd" = data$annd[complete.cases(data$annd)]
)
model_lm_trans <- lm(log(annd) ~ temp*log(gs,2) + trial + date, my_data)
summary(model_lm_trans)
plot(fitted(model_lm_trans),residuals(model_lm_trans))
newData1 <- data.frame(expand.grid(temp = seq(from = 9, to = 29, by = 1),
gs = c(1,2,4,8,16),
trial = unique(my_data$trial),
date = unique(my_data$date)))
boots <- 10000
yest <- matrix(NA,nrow=nrow(newData1),ncol=boots)
for(i in 1:boots){
ynew <- unlist(simulate(model_lm_trans))
ymod <- update(model_lm_trans,ynew ~ .)
yest[,i] <- predict(ymod,newdata = newData1, type="response")
}
data <- read.csv("../../data/temp_collective/roi/stats_loom_latency_nan.csv",header=TRUE,na.strings=c("[nan]"))
lat <- data$latency
#lat <- as.numeric(lat1)
temp <- data$Temperature
gs <- data$Groupsize
loom <- data$loom
model_pois6 <- glm(lat ~ temp + gs*loom + I(temp^2), family = quasipoisson, data)
summary(model_pois6)
install.packages("ciTools")
library(ciTools)
fitted_model <- fit(model_pois6, data)
dat2 <- predict(fitted_model, uncertain = FALSE, alpha = 0.1)
