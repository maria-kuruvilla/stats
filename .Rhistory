plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.0813 #interaction not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2) + temp*loom + I(temp^2)*loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.0817 #second interaction not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.0817 #second and third interaction not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom + loom*log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.0817 #second interaction not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom +
loom*log(gs,2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom +
loom*log(gs,2) + date + t, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.085 #second interaction not significant # date not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom +
loom*log(gs,2) + date + t1, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.083 #second interaction not significant # date not significant # t not significant
data <- read.csv("../../data/temp_collective/roi/convex_hull_ratio_600_650w_loom.csv")
data <- read.csv("../../data/temp_collective/roi/convex_hull_ratio_600_650w_loom.csv")
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$convex_hull_area_ratio)],
"gs" = data$Groupsize[complete.cases(data$convex_hull_area_ratio)],
"loom" = data$Loom[complete.cases(data$convex_hull_area_ratio)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$convex_hull_area_ratio)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$convex_hull_area_ratio)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$convex_hull_area_ratio)],
"subtrial" = data$Subtrial[complete.cases(data$convex_hull_area_ratio)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")),
"hull" = data$convex_hull_area_ratio[complete.cases(data$convex_hull_area_ratio)]
)
hist(my_data$hull)
hist(my_data$hull,20)
model_lm <- lm(hull~ gs + temp + loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull) ~ gs + temp + loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
qqnorm(residuals(model_lm), main= "")
qqline(residuals(model_lm))
model_lm <- lm(log(hull) ~ gs + temp + loom + temp*gs, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull) ~ gs + temp + loom + temp*loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull) ~ gs + temp + loom + temp*loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull) ~ gs + temp + loom + temp*loom + date + t, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$convex_hull_area_ratio)],
"gs" = data$Groupsize[complete.cases(data$convex_hull_area_ratio)],
"loom" = data$Loom[complete.cases(data$convex_hull_area_ratio)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$convex_hull_area_ratio)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$convex_hull_area_ratio)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$convex_hull_area_ratio)],
"subtrial" = data$Subtrial[complete.cases(data$convex_hull_area_ratio)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M"))),
"hull" = data$convex_hull_area_ratio[complete.cases(data$convex_hull_area_ratio)]
)
model_lm <- lm(log(hull) ~ gs + temp + loom + temp*loom + date + t, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull) ~ gs + temp + loom + temp*loom + date + t1, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
qqnorm(residuals(model_lm), main= "")
qqline(residuals(model_lm))
data <- read.csv("../../data/temp_collective/roi/convex_hull_ratio_600_650w_loom.csv")
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$convex_hull_area_ratio_loom)],
"gs" = data$Groupsize[complete.cases(data$convex_hull_area_ratio_loom)],
"loom" = data$Loom[complete.cases(data$convex_hull_area_ratio_loom)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$convex_hull_area_ratio_loom)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$convex_hull_area_ratio_loom)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$convex_hull_area_ratio_loom)],
"subtrial" = data$Subtrial[complete.cases(data$convex_hull_area_ratio_loom)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M"))),
"hull" = data$convex_hull_area_ratio_loom[complete.cases(data$convex_hull_area_ratio_loom)]
)
hist(my_data$hull,20)
hist(log(my_data$hull),20)
model_lm <- lm(hull~ gs + temp + loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#r sq = 0.01
qqnorm(residuals(model_lm), main= "")
qqline(residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + loom + date + t, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + loom + date + t1, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#r sq = 0.043
qqnorm(residuals(model_lm), main= "")
qqline(residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + loom + date + gs*temp, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#r sq = 0.043
model_lm <- lm(log(hull)~ gs + temp + loom + date + gs*temp + temp*loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
qqnorm(residuals(model_lm), main= "")
qqline(residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + I(temp^2) + loom + date + gs*temp + temp*loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + I(temp^2) + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ gs + temp + I(temp^2) + loom + date + I(temp^2)*gs, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ log(gs,2) + temp + I(temp^2) + loom + date + I(temp^2)*log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ log(gs,2) + I(temp^2) + loom + date + I(temp^2)*log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ log(gs,2) + I(temp^2) + loom + date + I(temp^2)*loom, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#r sq = 0.04471 # interaction not significant
model_lm <- lm(log(hull)~ log(gs,2) + I(temp^2) + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(hull)~ log(gs,2) + I(temp^2) + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
newData1 <- data.frame(expand.grid(temp = seq(from = 9, to = 29, by = 1),
gs = c(4,8,16),
loom = c(1,2,3,4,5), date = unique(my_data$date)))
boots <- 10000
yest <- matrix(NA,nrow=nrow(newData1),ncol=boots)
for(i in 1:boots){
ynew <- unlist(simulate(model_lm))
ymod <- update(model_lm,ynew ~ .)
yest[,i] <- predict(ymod,newdata = newData1, type="response")
}
results <- matrix(NA,nrow=nrow(newData1),ncol=3)
results[,1] <- predict(model_lm,newData1, type = "response")
for(j in 1:nrow(newData1)){
results[j,2] <- quantile(yest[j,],probs = c(0.025))
results[j,3] <- quantile(yest[j,],probs = c(0.975))
}
newData1$hull <- results[,1]
newData1$hull025 <- results[,2]
newData1$hull975 <- results[,3]
write.csv(newData1,"/home/maria/Documents/data/temp_collective/roi/hull_ratio_600_650_predictions2.csv")
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle3.csv",header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$startle_data_percentile99)],
"gs" = data$Groupsize[complete.cases(data$startle_data_percentile99)],
"loom" = data$Loom[complete.cases(data$startle_data_percentile99)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$startle_data_percentile99)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$startle_data_percentile99)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$startle_data_percentile99)],
"subtrial" = data$Subtrial[complete.cases(data$startle_data_percentile99)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$startle_data_percentile99)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$startle_data_percentile99)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$startle_data_percentile99)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$startle_data_percentile99)], format = "%H:%M"))),
"speed" = data$startle_data_percentile99[complete.cases(data$startle_data_percentile99)]
)
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom +
loom*log(gs,2) + date + t1, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.083 #second interaction not significant # date not significant # t1 not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2) +
loom*log(gs,2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.085 #second interaction not significant # date not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
plot(my_data$temp. my_data$speed)
plot(my_data$temp. my_data$speed)
plot(my_data$temp, my_data$speed)
which(my_data$speed>30)
which(my_data$speed>100)
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle_corrected.csv",header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$distance)],
"gs" = data$Groupsize[complete.cases(data$distance)],
"loom" = data$Loom[complete.cases(data$distance)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$distance)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$distance)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$distance)],
"subtrial" = data$Subtrial[complete.cases(data$distance)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M"))),
"distance" = data$distance[complete.cases(data$distance)]
)
model_lm <- lm(log(distance) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(distance+1) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(distance+1) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(distance+1) ~ temp + gs, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(distance+1) ~ temp + gs + I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(distance+1) ~ temp + log(gs,2) + I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
hist(my_data$distance)
hist(my_data$distance,20)
hist(log(my_data$distance),20)
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$startle_data_percentile99)],
"gs" = data$Groupsize[complete.cases(data$startle_data_percentile99)],
"loom" = data$Loom[complete.cases(data$startle_data_percentile99)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$startle_data_percentile99)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$startle_data_percentile99)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$startle_data_percentile99)],
"subtrial" = data$Subtrial[complete.cases(data$startle_data_percentile99)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$startle_data_percentile99)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$startle_data_percentile99)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$startle_data_percentile99)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$startle_data_percentile99)], format = "%H:%M"))),
"speed" = data$startle_data_percentile99[complete.cases(data$startle_data_percentile99)]
)
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + I(temp^2)*log(gs,2)  + I(temp^2)*loom +
loom*log(gs,2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
plot(my_data$temp,my_data$speed)
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.05
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + loom*temp, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.05 # temp and temp^2 significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + loom*I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + loom*I(temp^2) + loom*temp, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.049 # temp and temp^2 significant # interaction not significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.051 # temp and temp^2 significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + date + t, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.052 # temp and temp^2 significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + date + t + t1, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.052 # temp and temp^2 significant
model_lm <- lm(log(speed) ~ temp + log(gs,2) + loom + I(temp^2) + loom*log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.052 # temp and temp^2 significant
model_lm <- lm(log(speed) ~ temp +loom + I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.049 # temp and temp^2 significant
model_lm <- lm(log(speed) ~ temp +loom + I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.049 # temp and temp^2 significant
newData1 <- data.frame(expand.grid(temp = seq(from = 9, to = 29, by = 1),
loom = c(1,2,3,4,5)))
boots <- 10000
yest <- matrix(NA,nrow=nrow(newData1),ncol=boots)
for(i in 1:boots){
ynew <- unlist(simulate(model_lm))
ymod <- update(model_lm,ynew ~ .)
yest[,i] <- predict(ymod,newdata = newData1, type="response")
}
results <- matrix(NA,nrow=nrow(newData1),ncol=3)
results[,1] <- predict(model_lm,newData1, type = "response")
for(j in 1:nrow(newData1)){
results[j,2] <- quantile(yest[j,],probs = c(0.025))
results[j,3] <- quantile(yest[j,],probs = c(0.975))
}
newData1$speed99 <- results[,1]
newData1$speed99_025 <- results[,2]
newData1$speed99_975 <- results[,3]
write.csv(newData1,"/home/maria/Documents/data/temp_collective/roi/startle_speed99_predictions.csv")
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle_corrected.csv",header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$avg_startle_speed)],
"gs" = data$Groupsize[complete.cases(data$avg_startle_speed)],
"loom" = data$Loom[complete.cases(data$avg_startle_speed)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$avg_startle_speed)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$avg_startle_speed)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$avg_startle_speed)],
"subtrial" = data$Subtrial[complete.cases(data$avg_startle_speed)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$avg_startle_speed)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$avg_startle_speed)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$avg_startle_speed)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$avg_startle_speed)], format = "%H:%M"))),
"speed" = data$avg_startle_speed[complete.cases(data$avg_startle_speed)]
)
model_lm <- lm(log(speed) ~ temp +loom + I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(speed) ~ temp +loom + I(temp^2) + log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#good residuals #r sq = 0.017 # temp and temp^2 significant
data$distance[data$distance != 0 ]
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle_corrected2.csv",header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$distance)],
"gs" = data$Groupsize[complete.cases(data$distance)],
"loom" = data$Loom[complete.cases(data$distance)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$distance)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$distance)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$distance)],
"subtrial" = data$Subtrial[complete.cases(data$distance)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M"))),
"distance" = data$distance[complete.cases(data$distance)]
)
hist(my_data$distance,20)
hist(my_data$distance)
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle_corrected.csv",header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$distance)],
"gs" = data$Groupsize[complete.cases(data$distance)],
"loom" = data$Loom[complete.cases(data$distance)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$distance)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$distance)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$distance)],
"subtrial" = data$Subtrial[complete.cases(data$distance)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M"))),
"distance" = data$distance[complete.cases(data$distance)]
)
hist(my_data$distance,20)
my_data<-data.frame("temp" = data$Temperature[data$distance != 0],
"gs" = data$Groupsize[data$distance != 0],
"loom" = data$Loom[data$distance != 0],
"kt"=1/(0.00008617*(data$Temperature[data$distance != 0]+273.1)),
"date"=as.numeric(as.Date(data$Date[data$distance != 0], format = "%d/%m/%Y")),
"trial" = data$Trial[data$distance != 0],
"subtrial" = data$Subtrial[data$distance != 0],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[data$distance != 0], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[data$distance != 0], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[data$distance != 0], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[data$distance != 0], format = "%H:%M"))),
"distance" = data$distance[data$distance != 0]
)
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle_corrected.csv",header=TRUE,na.strings=c("[nan]"))
# make new dataframe
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$distance)],
"gs" = data$Groupsize[complete.cases(data$distance)],
"loom" = data$Loom[complete.cases(data$distance)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$distance)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$distance)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$distance)],
"subtrial" = data$Subtrial[complete.cases(data$distance)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$distance)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$distance)], format = "%H:%M"))),
"distance" = data$distance[complete.cases(data$distance)]
)
hist(my_data$distance,20)
my_data<-data.frame("temp" = data$Temperature[data$distance != 0],
"gs" = data$Groupsize[data$distance != 0],
"loom" = data$Loom[data$distance != 0],
"kt"=1/(0.00008617*(data$Temperature[data$distance != 0]+273.1)),
"date"=as.numeric(as.Date(data$Date[data$distance != 0], format = "%d/%m/%Y")),
"trial" = data$Trial[data$distance != 0],
"subtrial" = data$Subtrial[data$distance != 0],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[data$distance != 0], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[data$distance != 0], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[data$distance != 0], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[data$distance != 0], format = "%H:%M"))),
"distance" = data$distance[data$distance != 0]
)
hist(my_data$distance,20)
hist(log(my_data$distance),20)
model_lm <- lm(log(distance) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
model_lm <- lm(log(distance) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2) + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
# r sq = 0.11 #interactions are all significant
model_lm <- lm(log(distance) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2) + t, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
# r sq = 0.1265 #interactions are all significant
model_lm <- lm(log(distance) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2) + t1, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
# r sq = 0.1161 #interactions are all significant
model_lm <- lm(log(distance) ~ temp + gs + temp*gs + loom*temp + I(temp^2)*gs + loom*I(temp^2) + date + loom*gs, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
# r sq = 0.1265 #interactions are all significant
model_lm <- lm(log(distance) ~ temp + log(gs,2) + temp*log(gs,2) + loom*temp + I(temp^2)*log(gs,2) + loom*I(temp^2) +
date + loom*log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
# r sq = 0.1275 #interactions are all significant
model_lm <- lm(log(distance) ~ temp + log(gs,2) + temp*log(gs,2) + loom*temp + I(temp^2)*log(gs,2) + loom*I(temp^2) +
date + loom*log(gs,2), my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
# r sq = 0.154 #interactions are all significant
newData1 <- data.frame(expand.grid(temp = seq(from = 9, to = 29, by = 1), gs = c(1,2,4,8,16),
loom = c(1,2,3,4,5), date = unique(my_data$date)))
boots <- 10000
yest <- matrix(NA,nrow=nrow(newData1),ncol=boots)
for(i in 1:boots){
ynew <- unlist(simulate(model_lm))
ymod <- update(model_lm,ynew ~ .)
yest[,i] <- predict(ymod,newdata = newData1, type="response")
}
results <- matrix(NA,nrow=nrow(newData1),ncol=3)
results[,1] <- predict(model_lm,newData1, type = "response")
for(j in 1:nrow(newData1)){
results[j,2] <- quantile(yest[j,],probs = c(0.025))
results[j,3] <- quantile(yest[j,],probs = c(0.975))
}
newData1$distance <- results[,1]
newData1$distance_025 <- results[,2]
newData1$distance_975 <- results[,3]
write.csv(newData1,"/home/maria/Documents/data/temp_collective/roi/startle_distance_predictions3.csv")
qqnorm(residuals(model_lm))
qqline(residuals(model_lm))
data <- read.csv("../../data/temp_collective/roi/all_params_w_loom_startle_corrected3.csv",header=TRUE,na.strings=c("[nan]"))
data <- read.csv("../../data/temp_collective/roi/convex_hull_ratio_649_650w_loom2.csv")
data <- read.csv("../../data/temp_collective/roi/convex_hull_ratio_649_650_w_loom2.csv")
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$convex_hull_area_ratio)],
"gs" = data$Groupsize[complete.cases(data$convex_hull_area_ratio)],
"loom" = data$Loom[complete.cases(data$convex_hull_area_ratio)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$convex_hull_area_ratio)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$convex_hull_area_ratio)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$convex_hull_area_ratio)],
"subtrial" = data$Subtrial[complete.cases(data$convex_hull_area_ratio)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio)], format = "%H:%M"))),
"hull" = data$convex_hull_area_ratio[complete.cases(data$convex_hull_area_ratio)]
)
hist(my_data$hull,20)
hist(log(my_data$hull),20)
hist(log(my_data$hull + 1),20)
model_lm <- lm(log(hull)~ log(gs,2) + I(temp^2) + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
my_data<-data.frame("temp" = data$Temperature[complete.cases(data$convex_hull_area_ratio_loom)],
"gs" = data$Groupsize[complete.cases(data$convex_hull_area_ratio_loom)],
"loom" = data$Loom[complete.cases(data$convex_hull_area_ratio_loom)],
"kt"=1/(0.00008617*(data$Temperature[complete.cases(data$convex_hull_area_ratio_loom)]+273.1)),
"date"=as.numeric(as.Date(data$Date[complete.cases(data$convex_hull_area_ratio_loom)], format = "%d/%m/%Y")),
"trial" = data$Trial[complete.cases(data$convex_hull_area_ratio_loom)],
"subtrial" = data$Subtrial[complete.cases(data$convex_hull_area_ratio_loom)],
"t1" = as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M")),
"t2" = as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M")),
"t" = (as.numeric(as.POSIXct(data$Time_start_record[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M")) -
as.numeric(as.POSIXct(data$Time_fish_in[complete.cases(data$convex_hull_area_ratio_loom)], format = "%H:%M"))),
"hull" = data$convex_hull_area_ratio_loom[complete.cases(data$convex_hull_area_ratio_loom)]
)
model_lm <- lm(log(hull)~ log(gs,2) + I(temp^2) + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))
#r sq = 0.03 #temp and gs significant
model_lm <- lm(log(hull) ~ temp +  log(gs,2) + I(temp^2) + loom + date, my_data)
summary(model_lm)
plot(fitted(model_lm),residuals(model_lm))